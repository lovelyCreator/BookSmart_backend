"use strict";var jwtEncode=require("jwt-encode"),db=require("../models"),User=db.users,secret="secret";exports.create=function(r,s){return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:User.find({}).then(function(e){s.send(e)}).catch(function(e){s.status(500).send({message:e.message||"Some error occurred while retrieving spots."})}),User.find({email:r.body.email}).then(function(e){if(0===e.length){var s=new User({id:r.body.id,email:r.body.email,firstName:r.body.firstName,lastName:r.body.lastName,password:r.body.password,authToken:r.body.authToken,userId:r.body.userId});s.save(s)}}).catch(function(e){s.status(500).send({message:e.message||"Some error occurred while retrieving spots."})});case 2:case"end":return e.stop()}})},exports.login=function(t,n){var o,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:o=t.body.time,a=t.body.time+600,User.find({email:t.body.email}).then(function(e){if(0===e.length)n.send("There is no user");else if(e[0].password!==t.body.password)n.send("Wrong Password");else{var s=e[0].id,r={serviceToken:jwtEncode({userId:s,iat:o,exp:a},secret),user:{email:e[0].email,id:e[0]._id,name:"".concat(e[0].firstName," ").concat(e[0].lastName),userId:e[0].userId,authToken:e[0].authToken}};n.send(r)}}).catch(function(e){n.status(500).send({message:e.message||"Some error occurred while retrieving spots."})});case 3:case"end":return e.stop()}})};
//# sourceMappingURL=user.controller.min.js.map
